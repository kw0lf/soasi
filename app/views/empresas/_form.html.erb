<%= javascript_pack_tag "form_empresa" %>

    <%= content_tag :div,
    id: 'empresa-form',
    data: {
        id: empresa.id,
        empresa: empresa.to_json(except: [:id, :created_at, :updated_at]),
        pacientes_attributes: empresa.pacientes.to_json(except: [:empresa_id, :created_at, :updated_at]),
     } do %>
        <div v-if="!Object.keys(errores).length == 0">
            <em> Han ocurrido algunos errores que evitan el guardado:</em>
        </div>
        <div v-for="value, key in errores">
            <div id="card-alert" class="card red">
                <div class="card-content white-text">
                    <transition>
                        <p><i class="fa fa-ban"></i> <b>{{key.toUpperCase()}} {{ value[0].toUpperCase() }}</b></p>
                    </transition>
                </div>
                <button type="button" class="close white-text" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">Ã—</span>
                </button>
            </div>
        </div>
    <div class="row">
        <div class="input-field col s6">
            <input type="text" placeholder="Empresa Ejemplo C.A (ejemplo)"  v-model="empresa.nombre" v-validate="{required:true, regex: /[a-zA-Z0-9 -,.()]$/}" name="empresa_nombre"  id="empresa_nombre"  data-vv-as="Nombre de la empresa" />
            <span v-if="errors.has('empresa_nombre')"  class="red-text-error ">
                    {{ errors.first('empresa_nombre') }}
                </span>
                <label> Nombre de la empresa</label>

        </div>

        <div class="input-field col s6">
            <label>Ruc de la empresa</label>
            <input type="text" placeholder="1760001550001 (ejemplo)"  v-model="empresa.ruc" data-vv-as="RUC de la empresa" name="empresa_ruc"  v-validate="'required|numeric'"/>
            <span v-if="errors.has('empresa_ruc')"  class="red-text-error ">
                {{ errors.first('empresa_ruc') }}
            </span>
        </div>
    </div>
    <div class="row">
        <div class="input-field col s6">
            <label>Numero Telefonico</label>
            <input type="text" placeholder="0056113368551 (ejemplo)" v-model="empresa.telefono" data-vv-as="Telefono de la empresa" name="empresa_telefono" v-validate="'required|numeric'"/>
            <span v-if="errors.has('empresa_telefono')"  class="red-text-error ">
                    {{ errors.first('empresa_telefono') }}
            </span>
        </div>

        <div class="input-field col s6">
            <label>Email</label>
            <input type="text" placeholder="correo@empresa.com (ejemplo)" v-model="empresa.email" v-validate="'required|email'" name="empresa_email" data-vv-as="Email de la empresa" name="empresa_email">
            <i v-show="errors.has('email')" class="fa fa-warning"></i>

            <span v-if="errors.has('empresa_email')"  class="red-text-error">
                {{ errors.first('empresa_email') }}
            </span>

        </div>
    </div>
    <div class="row">
        <div class="input-field col s12">
            <label for="direccion">Direccion</label>
            <input type="text" placeholder="Edificio Seven, Oficina 01 , Calle 1 , Capital (ejemplo)" v-model="empresa.ubicacion" v-validate="{required:true, regex: /[a-zA-Z0-9 -,.()]$/}" data-vv-as="Direccion de la empresa" name="empresa_direccion"   />
            <span v-if="errors.has('empresa_direccion')"  class="red-text-error">
                    {{ errors.first('empresa_direccion') }}
                </span>
        </div>
    </div>
        <!--EMPLEADOS -->
        <h4>Empleados </h4>
        <div v-for="(paciente, index) in empresa.pacientes_attributes">
            <div v-if="paciente._destroy == '1'">
                El paciente
                <b>{{ paciente.primer_nombre }}</b> fue removido
                <button v-on:click="undoRemove(index)" class="waves-effect waves-light btn btn-sm ">
                    Deshacer</button>
            </div>
            <div v-else>
                <label for="">Nombre </label>
                <input type="text" v-model="paciente.primer_nombre" />
                <button v-on:click="removePaciente(index)" class="waves-effect waves-light btn "> Borrar </button>
            </div>
            <hr>
        </div>
        <button v-on:click="addPaciente" class="waves-effect waves-light btn btn-sm "> Agregar </button>
        <button v-on:click="saveEmpresa" :disabled="errors.any()" class="waves-effect waves-light btn btn-sm "> Guardar </button>

        <% end %>


            <br />
